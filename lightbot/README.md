todo

记录每个人的类型需求。

keywords关键

记录sur发了

3次 

13





user_keyword

user_id, keyword, 12





at某人

Event类



实现一个机器人类



触发bot回复的3种情况：

- 被at + 关键词
- 命令首字符（如`/`）+ 关键词
- 直接关键词



要想给bot增加匹配新命令的功能，直接编写函数即可，不需要改主函数。



运行bot。事件循环，对每个事件解析、针对满足条件的事件作出相应的处理



对每个event，解析event：

- 机器人查看事件
  - 逐个匹配命令，执行命令



机器人类：实现所有go-cqhttp的api



to do

- 错误重连，连续错误3次才退出程序

message解析

### 命令触发

设定一个优先级顺序，命令触发后就不会触发其他命令了

每个命令应该有单独的连接，结束后释放。

命令触发条件

`check_command_trigger()`

检测命令是否被触发，具体方案有：

直接匹配：关键词在句子内就触发。如关键词为天气，句子“明天天气怎样？”就会触发查询天气请求

句首匹配：关键词在句首。如关键词为“夸”，句子为“夸鱼哥”就会触发夸人请求。

### 插件编写

每个插件应该是一个类，具有以下基础功能：

- 设置触发条件
- 检查是否触发
- 开放部分接口供其他插件复用
- 命令触发有别名
- 回复多样化

复用场景，yy+骂人。



插件扩展，如果想要教机器人怎么对话怎么办。

### 核心架构

Api 事件 插件

事件触发插件的行为，插件返回Api告诉机器人该怎么做。


### 每次执行一个功能时

要调试插件很麻烦，我感觉可以改一改

调试插件不需要连接bot

每个功能的返回值：
 - Api对象，bot接收并执行这个Api对象
 - 如果返回None, 则不进行任何操作

事务链：目前机器人只会响应单个指令

要想实现诸如背单词、玩游戏等功能就不知如何进行了。


### 插件的设计

有的插件比较小，只有一个函数

有的插件比较大，由多个函数组成

插件 - Plugin

